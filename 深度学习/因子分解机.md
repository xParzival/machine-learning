# 因子分解机
* 因子分解机模型，即Factorization Machines Model，简称FM
* FM模型可以用于回归任务、二分类任务、排名任务，特别是在数据稀疏场景下，效果明显，广泛应用于推荐系统、广告系统等领域
* 目前来看，FM模型是推荐系统、广告系统的三大基础模型之一，如果想从事推荐、广告相关的工作、研究、学习，是必须要掌握的

## 引入
首先回顾一下线性回归：
$$
Y=W^{\boldsymbol{T}}X=w_0+\sum_{i=1}^nw_ix_i
$$

线性回归只有一次项，效果不好：
1. 特征稀疏的场景当中
2. 线性回归假设特征之间相互独立，实际特征之间往往是相关的

我们做特征的时候经常会把特征组合起来做成新的组合特征，由于我们这样操作引入了新的特征，找到了新的特征组合，所以能够挖掘出之前无法得到的信息，因此模型也会有更好的效果。POLY2模型就是一种暴力将所有特征两两组合的方式得到的模型：
$$
y=w_0+\sum_{i=1}^nw_ix_i+\sum_{i=1}^{n-1}\sum_{j=i+1}^{n}w_{ij}x_ix_j
$$

对于n维特征这样的组合就有$\frac{n(n-1)}{2}$种，参数也需要$\frac{n(n-1)}{2}$个，在维数很高时带来的参数量是天文数字，且特征非常稀疏，会导致模型训练无法完全收敛。为了解决这个问题诞生了因子分解机，它既引入了特征交叉，又解决了复杂度以及模型参数的问题

## 因子分解机
因子分解机的优势是为每个特征学习了一个隐权重向量(latent vector)，在特征交叉的时候，用这两个特征隐向量内积作为交叉特征的权重。对二阶交叉特征的系数以矩阵分解的方式调整，让系数不再是独立无关的，同时解决数据稀疏导致的无法训练参数的问题
对于$n$维特征，引入一个$k\times n$的矩阵$V=(\boldsymbol{v_1},\boldsymbol{v_2},\cdots,\boldsymbol{v_n})$，其中$k$是给定的一个参数，对于每一个维度，我们都可以找到一个$k$维向量$\boldsymbol{v_i}$。因子分解机用向量$\boldsymbol{v_i}$之间的内积来计算得出POLY2模型中的$w_{ij}$
$$
w_{ij}=<\boldsymbol{v_i},\boldsymbol{v_j}>=\boldsymbol{v_i}^{\boldsymbol{T}}\boldsymbol{v_j}
$$


$$
y=w_0+\sum_{i=1}^nw_ix_i+\sum_{i=1}^{n-1}\sum_{j=i+1}^{n}<>x_ix_j
$$